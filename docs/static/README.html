
<p>Object parser and serializer factories to simplify object configurations</p>
<h3 id="status">Status</h3>
<table>
<thead>
<tr class="header">
<th>Source</th>
<th>Shields</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Project</td>
<td><img src="https://img.shields.io/github/license/joellefkowitz/yummy-cereal" alt="license" /> <img src="https://img.shields.io/github/v/tag/joellefkowitz/yummy-cereal" alt="release" /></td>
</tr>
<tr class="even">
<td>Publishers</td>
<td><a href="https://pypi.org/project/yummy-cereal"><img src="https://img.shields.io/pypi/v/yummy-cereal" title="PyPi" alt="pypi" /></a></td>
</tr>
<tr class="odd">
<td>Downloads</td>
<td><img src="https://img.shields.io/pypi/dw/yummy-cereal" alt="pypi_downloads" /></td>
</tr>
<tr class="even">
<td>Raised</td>
<td><a href="https://github.com/JoelLefkowitz/yummy-cereal/issues"><img src="https://img.shields.io/github/issues/joellefkowitz/yummy-cereal" title="Issues" alt="issues" /></a> <a href="https://github.com/JoelLefkowitz/yummy-cereal/pulls"><img src="https://img.shields.io/github/issues-pr/joellefkowitz/yummy-cereal" title="Pull requests" alt="pulls" /></a></td>
</tr>
</tbody>
</table>
<h3 id="installing">Installing</h3>
<p>To install the package from pypi:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="ex">pip</span> install yummy_cereal</span></code></pre></div>
<p>Alternatively, you can clone the repo and build the package locally.</p>
<h3 id="motivation">Motivation</h3>
<p>Parsing and serializing objects to and from configurations can become overly complicated, particularly if the objects are listed by name. Suitable factories avoid having to make specific parsers or an overly verbose configuration.</p>
<h4 id="parsing">Parsing</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1"></a><span class="pp">---</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Big munch grill</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">languages</span><span class="kw">:</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="at">  </span><span class="kw">-</span><span class="at"> English</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="at">  </span><span class="kw">-</span><span class="at"> French</span></span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">courses</span><span class="kw">:</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="at">  </span><span class="fu">Appetizers</span><span class="kw">:</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="at">    </span><span class="fu">Pico de Gallo</span><span class="kw">:</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="at">    </span><span class="fu">Pineapple Salsa</span><span class="kw">:</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="at">    </span><span class="fu">Oven Baked Soft Pretzels</span><span class="kw">:</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="at">    </span><span class="fu">Taco Ring</span><span class="kw">:</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="at">    </span><span class="fu">Pizza bites</span><span class="kw">:</span></span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="at">  </span><span class="fu">Main course</span><span class="kw">:</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="at">    </span><span class="fu">Pasta</span><span class="kw">:</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="at">      </span><span class="fu">Sauce</span><span class="kw">:</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Rose</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Alfredo</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Cream</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="at">      </span><span class="fu">Shapes</span><span class="kw">:</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Penne</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Bow-tie</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Ravioli</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="at">    </span><span class="fu">Pizza</span><span class="kw">:</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="at">      </span><span class="fu">Toppings</span><span class="kw">:</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Beef</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Bazil</span></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Tomato</span></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Peppers</span></span>
<span id="cb2-31"><a href="#cb2-31"></a></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="at">  </span><span class="fu">Desserts</span><span class="kw">:</span></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="at">    </span><span class="fu">Gooey Brownies</span><span class="kw">:</span></span>
<span id="cb2-34"><a href="#cb2-34"></a><span class="at">    </span><span class="fu">Butterfinger Cookie Dough</span><span class="kw">:</span></span>
<span id="cb2-35"><a href="#cb2-35"></a></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="fu">drinks</span><span class="kw">:</span></span>
<span id="cb2-37"><a href="#cb2-37"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Fruit juice</span></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Green tea</span></span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Coffee</span></span>
<span id="cb2-40"><a href="#cb2-40"></a></span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="fu">specials</span><span class="kw">:</span></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Banana split</span></span></code></pre></div>
<p>We can make simple annotated classes:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass, field</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">from</span> typing <span class="im">import</span> Any, Dict, List</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="at">@dataclass</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">class</span> Dish:</span>
<span id="cb3-7"><a href="#cb3-7"></a>    name: <span class="bu">str</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    details: Any <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="at">@dataclass</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="kw">class</span> Course:</span>
<span id="cb3-13"><a href="#cb3-13"></a>    name: <span class="bu">str</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>    dishes: List[Dish] <span class="op">=</span> field(default_factory<span class="op">=</span><span class="bu">list</span>)</span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="at">@dataclass</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="kw">class</span> Menu:</span>
<span id="cb3-19"><a href="#cb3-19"></a>    name: <span class="bu">str</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>    languages: List[<span class="bu">str</span>]</span>
<span id="cb3-21"><a href="#cb3-21"></a>    courses: List[Course] <span class="op">=</span> field(default_factory<span class="op">=</span><span class="bu">list</span>)</span>
<span id="cb3-22"><a href="#cb3-22"></a>    specials: List[Dish] <span class="op">=</span> field(default_factory<span class="op">=</span><span class="bu">list</span>)</span>
<span id="cb3-23"><a href="#cb3-23"></a>    drinks: List[Dish] <span class="op">=</span> field(default_factory<span class="op">=</span><span class="bu">list</span>)</span></code></pre></div>
<p>And then create parsers:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>  dish_parser <span class="op">=</span> AnnotationsParser(Dish)</span>
<span id="cb4-2"><a href="#cb4-2"></a>  </span>
<span id="cb4-3"><a href="#cb4-3"></a>  course_parser <span class="op">=</span> AnnotationsParser(Course, specified_parsers<span class="op">=</span>{Dish: dish_parser})</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>  menu_parser <span class="op">=</span> AnnotationsParser(</span>
<span id="cb4-6"><a href="#cb4-6"></a>      Menu, specified_parsers<span class="op">=</span>{Course: course_parser}</span>
<span id="cb4-7"><a href="#cb4-7"></a>  )</span></code></pre></div>
<p>Finally, we can parse the objects:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">from</span> ruamel.yaml <span class="im">import</span> load, Loader</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="cf">with</span> <span class="bu">open</span>(config, <span class="st">&quot;r&quot;</span>) <span class="im">as</span> stream:</span>
<span id="cb5-4"><a href="#cb5-4"></a>    menu_config <span class="op">=</span> load(stream, Loader<span class="op">=</span>Loader)</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a>menu <span class="op">=</span> menu_parser(menu_config)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="ex">menu</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="ex">Menu</span>(name=<span class="st">&#39;Big munch grill&#39;</span>, languages=[<span class="st">&#39;English&#39;</span>, <span class="st">&#39;French&#39;</span>], courses=[Course(name=<span class="st">&#39;Appetizers&#39;</span>...</span></code></pre></div>
<p>Attributes called “name” have been inferred from the dictionary style layout of the configuration.</p>
<h4 id="validation">Validation</h4>
<p>We can specify a list of validation checks to perform before parsing the configuration data:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">from</span> yummy_cereal <span class="im">import</span> ValidatedParser</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>validators <span class="op">=</span> [</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="kw">lambda</span> config: config[<span class="st">&quot;name&quot;</span>] <span class="op">!=</span> <span class="st">&quot;Big munch grill&quot;</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>]</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a>ValidatedParser(menu_parser, validators)</span></code></pre></div>
<h4 id="serializing">Serializing</h4>
<p>Just as we did with parsers, we can use class annotations to construct serializers:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">from</span> yummy_cereal <span class="im">import</span> AnnotationsSerializer</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>dish_serializer <span class="op">=</span> AnnotationsSerializer(Dish)</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a>course_serializer <span class="op">=</span> AnnotationsSerializer(</span>
<span id="cb8-6"><a href="#cb8-6"></a>    Course, specified_serializers<span class="op">=</span>{Dish: dish_serializer}</span>
<span id="cb8-7"><a href="#cb8-7"></a>)</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a>menu_serializer <span class="op">=</span> AnnotationsSerializer(</span>
<span id="cb8-10"><a href="#cb8-10"></a>    Menu, specified_serializers<span class="op">=</span>{Course: course_serializer, Dish: dish_serializer}</span>
<span id="cb8-11"><a href="#cb8-11"></a>)</span></code></pre></div>
<h3 id="docs">Docs</h3>
<p>Additional details are available in the <a href="https://yummy-cereal.readthedocs.io/en/latest/">full documentation</a>.</p>
<p>To generate the documentation locally:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="ex">multi-job</span> docs</span></code></pre></div>
<h3 id="tests">Tests</h3>
<p>Unit tests and behaviour tests are written with the pytest framework.</p>
<p>To run tests:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1"></a><span class="ex">multi-job</span> tests</span></code></pre></div>
<p>Additionally, an html report will be saved to the local directory.</p>
<h3 id="contributing">Contributing</h3>
<p>Please read <a href="CONTRIBUTING.md">CONTRIBUTING.md</a> for details on our code of conduct, and the process for submitting pull requests.</p>
<h3 id="versioning">Versioning</h3>
<p><a href="http://semver.org/">SemVer</a> is used for versioning. For a list of versions available, see the tags on this repository.</p>
<p>Bump2version is used to version and tag changes. For example:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a><span class="ex">bump2version</span> patch</span></code></pre></div>
<p>Releases are made on every major change.</p>
<h3 id="author">Author</h3>
<ul>
<li><strong>Joel Lefkowitz</strong> - <em>Initial work</em> - <a href="https://github.com/JoelLefkowitz">Joel Lefkowitz</a></li>
</ul>
<p>See also the list of contributors who participated in this project.</p>
<h3 id="license">License</h3>
<p>This project is licensed under the MIT License - see the <a href="LICENSE.md">LICENSE.md</a> file for details</p>
<h3 id="acknowledgments">Acknowledgments</h3>
<p>None yet!</p>
<!--- Table links --->
